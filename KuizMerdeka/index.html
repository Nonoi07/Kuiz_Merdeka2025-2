<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kuiz Merdeka Malaysia</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .flag-gradient { background: linear-gradient(45deg, #FF0000, #FFFFFF, #0000FF); }
        .pulse-animation { animation: pulse 2s infinite; }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-red-50 to-blue-50 min-h-screen transition-all duration-300" id="body">
    <!-- Header -->
    <header class="bg-gradient-to-r from-red-600 to-blue-600 text-white py-6 shadow-lg">
        <div class="container mx-auto px-4">
            <!-- Top Row: Logo and Dark Mode Toggle -->
            <div class="absolute top-4 right-4">
             <!-- Dark Mode Toggle - Top Right -->
                <button onclick="toggleDarkMode()" 
                        class="bg-white/20 hover:bg-white/30 text-white p-2 rounded-lg transition-all">
                    <span id="darkModeIcon">üåô</span>
                </button>
            </div>

            <!-- KV Logo - Top Left -->
            <div class="absolute top-4 left-4">
                <!-- ‚¨áÔ∏è TUKAR URL GAMBAR KV ANDA DI SINI ‚¨áÔ∏è -->
                <img src="logo_kv_png.png" 
                     alt="Logo KV" 
                     class="w-60 h-30  rectangle-full p-2 "
                     onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                <!-- Fallback SVG Logo (akan keluar jika gambar tak load) -->
                <svg width="80" height="80" viewBox="0 0 100 100" class="bg-white rounded-full p-2 shadow-lg hidden">
                    <circle cx="50" cy="50" r="45" fill="#1e40af" stroke="#dc2626" stroke-width="2"/>
                    <circle cx="50" cy="50" r="35" fill="#ffffff" opacity="0.9"/>
                    <rect x="35" y="35" width="30" height="20" fill="#1e40af" rx="2"/>
                    <rect x="37" y="37" width="26" height="16" fill="#ffffff"/>
                    <line x1="40" y1="42" x2="60" y2="42" stroke="#1e40af" stroke-width="1"/>
                    <line x1="40" y1="46" x2="55" y2="46" stroke="#1e40af" stroke-width="1"/>
                    <line x1="40" y1="50" x2="58" y2="50" stroke="#1e40af" stroke-width="1"/>
                    <circle cx="50" cy="65" r="8" fill="#dc2626"/>
                    <circle cx="50" cy="65" r="4" fill="#ffffff"/>
                    <text x="50" y="85" text-anchor="middle" fill="#1e40af" font-size="12" font-weight="bold">KV</text>
                </svg>
                
            </div>
            

            
                
            <!-- Center Content -->
            <div class="text-center">
                <h1 class="text-4xl font-bold mb-2">Kuiz Merdeka Malaysia</h1>
                <h1 class="text-3xl font-bold mb-2">Kolej Vokasional Lebuh Cator</h1>
                <p class="text-xl opacity-90">Uji pengetahuan anda tentang Tanah air kita !!!</p>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="container mx-auto px-4 py-8 max-w-4xl">
        <!-- Start Screen -->
        <div id="startScreen" class="text-center bg-white rounded-2xl shadow-xl p-8 mb-8">
            <div class="text-6xl mb-4">üèÜ</div>
            <h2 class="text-3xl font-bold text-gray-800 mb-4">Selamat Datang!</h2>
            <p class="text-gray-600 mb-6">Sila isi maklumat anda untuk memulakan kuiz</p>
            
            <div class="max-w-md mx-auto space-y-4 mb-6">
                <input type="text" id="playerFullName" placeholder="Nama Penuh..." 
                       class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg text-center text-lg focus:border-blue-500 focus:outline-none"
                       style="text-transform: uppercase;">
                <input type="tel" id="playerPhone" placeholder="No. Telefon (cth: 0123456789)" 
                       class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg text-center text-lg focus:border-blue-500 focus:outline-none">
            </div>
            
            <button onclick="startQuiz()" 
                    class="bg-gradient-to-r from-red-500 to-blue-500 text-white px-8 py-3 rounded-lg text-xl font-semibold hover:from-red-600 hover:to-blue-600 transition-all pulse-animation">
                Mula Kuiz
            </button>
            
            <div class="mt-6">
                <button onclick="showAdminLogin()" 
                        class="text-sm text-gray-500 hover:text-gray-700 underline">
                    Admin Panel
                </button>
            </div>
        </div>

        <!-- Quiz Screen -->
        <div id="quizScreen" class="hidden">
            <div class="bg-white rounded-2xl shadow-xl p-8 mb-6">
                <div class="flex justify-between items-center mb-6">
                    <div class="text-lg font-semibold text-gray-700">
                        Soalan <span id="currentQuestion">1</span> daripada <span id="totalQuestions">10</span>
                    </div>
                    <div class="text-lg font-semibold text-blue-600">
                        ‚è±Ô∏è <span id="timer">30</span>s
                    </div>
                </div>
                
                <div class="w-full bg-gray-200 rounded-full h-3 mb-6">
                    <div id="progressBar" class="bg-gradient-to-r from-red-500 to-blue-500 h-3 rounded-full transition-all duration-300" style="width: 10%"></div>
                </div>

                <h3 id="questionText" class="text-2xl font-bold text-gray-800 mb-6 text-center"></h3>
                
                <div id="answersContainer" class="space-y-4">
                    <!-- Answers will be populated here -->
                </div>
            </div>
        </div>

        <!-- Results Screen -->
        <div id="resultsScreen" class="hidden">
            <div class="bg-white rounded-2xl shadow-xl p-8 text-center mb-6">
                <div class="text-6xl mb-4">üéâ</div>
                <h2 class="text-3xl font-bold text-gray-800 mb-4">Tahniah!</h2>
                <div class="text-xl text-gray-600 mb-6">
                    <p>Skor anda: <span id="finalScore" class="font-bold text-blue-600"></span>/40</p>
                    <p>Masa total: <span id="totalTime" class="font-bold text-green-600"></span> saat</p>
                    <p class="text-lg mt-2">Nama: <span id="displayName" class="font-bold text-gray-800"></span></p>
                    <p class="text-lg">No. Tel: <span id="displayPhone" class="font-bold text-gray-800"></span></p>
                </div>
                <button onclick="showLeaderboard()" 
                        class="bg-gradient-to-r from-green-500 to-blue-500 text-white px-8 py-3 rounded-lg text-xl font-semibold hover:from-green-600 hover:to-blue-600 transition-all mr-4">
                    Lihat Papan Pendahulu
                </button>
                <button onclick="restartQuiz()" 
                        class="bg-gradient-to-r from-red-500 to-blue-500 text-white px-8 py-3 rounded-lg text-xl font-semibold hover:from-red-600 hover:to-blue-600 transition-all">
                    Main Lagi
                </button>
            </div>
        </div>

        <!-- Leaderboard -->
        <div id="leaderboardScreen" class="hidden">
            <div class="bg-white rounded-2xl shadow-xl p-8">
                <h2 class="text-3xl font-bold text-center text-gray-800 mb-6">üèÜ Papan Pendahulu</h2>
                <div class="text-sm text-gray-600 text-center mb-6">Kedudukan berdasarkan skor tertinggi dan masa terpantas</div>
                
                <div id="leaderboardList" class="space-y-4">
                    <!-- Leaderboard entries will be populated here -->
                </div>
                
                <div class="text-center mt-8">
                    <button onclick="restartQuiz()" 
                            class="bg-gradient-to-r from-red-500 to-blue-500 text-white px-8 py-3 rounded-lg text-xl font-semibold hover:from-red-600 hover:to-blue-600 transition-all">
                        Main Semula
                    </button>
                </div>
            </div>
        </div>

        <!-- Admin Login Screen -->
        <div id="adminLoginScreen" class="hidden">
            <div class="bg-white rounded-2xl shadow-xl p-8 max-w-md mx-auto">
                <h2 class="text-2xl font-bold text-center text-gray-800 mb-6">üîê Admin Panel</h2>
                
                <!-- Error Message -->
                <div id="loginError" class="hidden bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-4">
                    <div class="flex items-center">
                        <span class="text-xl mr-2">‚ùå</span>
                        <span id="errorMessage">ID atau password salah!</span>
                    </div>
                </div>
                
                <div class="space-y-4 mb-6">
                    <input type="text" id="adminId" placeholder="Admin ID" 
                           class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none">
                    <input type="password" id="adminPassword" placeholder="Password" 
                           class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none">
                </div>
                
                <div class="text-center space-x-4">
                    <button onclick="adminLogin()" 
                            class="bg-green-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-green-700 transition-all">
                        Log Masuk
                    </button>
                    <button onclick="backToStart()" 
                            class="bg-gray-500 text-white px-6 py-3 rounded-lg font-semibold hover:bg-gray-600 transition-all">
                        Kembali
                    </button>
                </div>
            </div>
        </div>

        <!-- Admin Panel -->
        <div id="adminPanel" class="hidden">
            <div class="bg-white rounded-2xl shadow-xl p-8">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-3xl font-bold text-gray-800">üìä Admin Panel</h2>
                    <button onclick="logoutAdmin()" 
                            class="bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition-all">
                        Log Keluar
                    </button>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <div class="bg-blue-50 p-6 rounded-lg text-center">
                        <div class="text-3xl font-bold text-blue-600" id="totalParticipants">0</div>
                        <div class="text-gray-600">Jumlah Peserta</div>
                    </div>
                    <div class="bg-green-50 p-6 rounded-lg text-center">
                        <div class="text-3xl font-bold text-green-600" id="averageScore">0</div>
                        <div class="text-gray-600">Purata Skor</div>
                    </div>
                    <div class="bg-yellow-50 p-6 rounded-lg text-center">
                        <div class="text-3xl font-bold text-yellow-600" id="averageTime">0s</div>
                        <div class="text-gray-600">Purata Masa</div>
                    </div>
                </div>
                
                <div class="mb-6">
                    <button onclick="exportData()" 
                            class="bg-green-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-green-700 transition-all mr-4">
                        üì• Export Data CSV
                    </button>
                    <button onclick="clearAllData()" 
                            class="bg-red-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-red-700 transition-all">
                        üóëÔ∏è Padam Semua Data
                    </button>
                </div>
                
                <div class="overflow-x-auto">
                    <table class="w-full border-collapse border border-gray-300">
                        <thead>
                            <tr class="bg-gray-100">
                                <th class="border border-gray-300 px-4 py-2 text-left">No.</th>
                                <th class="border border-gray-300 px-4 py-2 text-left">Nama Penuh</th>
                                <th class="border border-gray-300 px-4 py-2 text-left">No. Telefon</th>
                                <th class="border border-gray-300 px-4 py-2 text-left">Skor</th>
                                <th class="border border-gray-300 px-4 py-2 text-left">Masa (s)</th>
                                <th class="border border-gray-300 px-4 py-2 text-left">Tarikh</th>
                            </tr>
                        </thead>
                        <tbody id="adminDataTable">
                            <!-- Data will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Quiz data - All 40 questions
        const quizData = [
            // BAHAGIAN A: SEJARAH KEMERDEKAAN (30 SOALAN)
            {
                question: "Bilakah tarikh rasmi kemerdekaan Persekutuan Tanah Melayu?",
                answers: ["31 Julai 1957", "31 Ogos 1957", "16 September 1963", "31 Disember 1957"],
                correct: 1
            },
            {
                question: "Di manakah laungan 'Merdeka!' dilaungkan oleh Tunku Abdul Rahman?",
                answers: ["Parlimen Malaysia", "Padang Merdeka", "Stadium Merdeka", "Dataran Merdeka"],
                correct: 2
            },
            {
                question: "Siapakah Perdana Menteri pertama Malaysia?",
                answers: ["Tun Abdul Razak", "Tunku Abdul Rahman", "Tun Hussein Onn", "Tun Dr Mahathir Mohamad"],
                correct: 1
            },
            {
                question: "Apakah slogan Hari Kebangsaan tahun 2024?",
                answers: ["Malaysia Madani: Tekad Perpaduan Penuhi Harapan", "Keluarga Malaysia: Teguh Bersama", "Prihatin Rakyat", "Sayangi Malaysiaku"],
                correct: 0
            },
            {
                question: "Apakah nama dokumen penting yang menandakan kemerdekaan Tanah Melayu?",
                answers: ["Perlembagaan Malaysia", "Deklarasi Merdeka", "Rukun Negara", "Wasiat Raja-Raja"],
                correct: 1
            },
            {
                question: "Apakah gelaran Tunku Abdul Rahman?",
                answers: ["Bapa Perpaduan", "Bapa Kemerdekaan", "Bapa Pembangunan", "Bapa Reformasi"],
                correct: 1
            },
            {
                question: "Berapakah jumlah negeri asal dalam Persekutuan Tanah Melayu?",
                answers: ["10", "11", "13", "14"],
                correct: 1
            },
            {
                question: "Negara manakah yang memberi kemerdekaan kepada Tanah Melayu?",
                answers: ["Jepun", "Belanda", "Sepanyol", "British"],
                correct: 3
            },
            {
                question: "Siapakah tokoh yang mengetuai rundingan kemerdekaan ke London?",
                answers: ["Tun Abdul Razak", "Tunku Abdul Rahman", "Tun Dr Ismail", "Dato' Onn Jaafar"],
                correct: 1
            },
            {
                question: "Apakah peranan Suruhanjaya Reid?",
                answers: ["Menubuhkan kerajaan", "Menyediakan perlembagaan", "Menentukan tarikh kemerdekaan", "Menulis lagu kebangsaan"],
                correct: 1
            },
            {
                question: "Lagu kebangsaan Malaysia ialah?",
                answers: ["Malaysia Gemilang", "Tanah Tumpah Darahku", "Negaraku", "Jalur Gemilang"],
                correct: 2
            },
            {
                question: "Bendera Malaysia dikenali sebagai?",
                answers: ["Jalur Gemilang", "Sang Saka Merah Putih", "Merdeka Malaysia", "Bendera Rakyat"],
                correct: 0
            },
            {
                question: "Berapakah bilangan jalur pada Jalur Gemilang?",
                answers: ["12", "13", "14", "16"],
                correct: 2
            },
            {
                question: "Apakah warna pada bulan dan bintang Jalur Gemilang?",
                answers: ["Merah", "Kuning", "Biru", "Putih"],
                correct: 1
            },
            {
                question: "Lagu Negaraku diambil daripada lagu negeri manakah?",
                answers: ["Pahang", "Kedah", "Selangor", "Perak"],
                correct: 3
            },
            {
                question: "Negeri manakah yang menyertai Malaysia pada tahun 1963?",
                answers: ["Sabah dan Sarawak", "Pahang dan Perlis", "Melaka dan Negeri Sembilan", "Johor dan Terengganu"],
                correct: 0
            },
            {
                question: "Apakah maksud bintang pecah 14 dalam bendera Malaysia?",
                answers: ["14 daerah", "14 negeri", "Perpaduan 13 negeri dan kerajaan persekutuan", "14 bahasa"],
                correct: 2
            },
            {
                question: "Bilakah Hari Malaysia disambut?",
                answers: ["31 Ogos", "1 September", "16 September", "1 Ogos"],
                correct: 2
            },
            {
                question: "Negara manakah yang pernah menjadi sebahagian daripada Malaysia tetapi keluar?",
                answers: ["Thailand", "Singapura", "Brunei", "Indonesia"],
                correct: 1
            },
            {
                question: "Siapakah Yang di-Pertuan Agong pertama Malaysia?",
                answers: ["Sultan Perak", "Sultan Kedah", "Tuanku Abdul Rahman", "Sultan Johor"],
                correct: 2
            },
            // Benar/Palsu questions (21-30)
            {
                question: "Malaysia merdeka pada 31 Ogos 1963.",
                answers: ["Benar", "Palsu"],
                correct: 1,
                type: "truefalse"
            },
            {
                question: "Lagu kebangsaan kita dicipta oleh seorang rakyat Malaysia.",
                answers: ["Benar", "Palsu"],
                correct: 1,
                type: "truefalse"
            },
            {
                question: "Malaysia terdiri daripada 14 negeri termasuk Wilayah Persekutuan.",
                answers: ["Benar", "Palsu"],
                correct: 0,
                type: "truefalse"
            },
            {
                question: "Rukun Negara diperkenalkan selepas peristiwa 13 Mei 1969.",
                answers: ["Benar", "Palsu"],
                correct: 0,
                type: "truefalse"
            },
            {
                question: "Bendera Malaysia mempunyai 14 bintang.",
                answers: ["Benar", "Palsu"],
                correct: 1,
                type: "truefalse"
            },
            {
                question: "Jalur Merah Putih adalah nama asal Jalur Gemilang.",
                answers: ["Benar", "Palsu"],
                correct: 1,
                type: "truefalse"
            },
            {
                question: "Rukun Negara ada lima prinsip utama.",
                answers: ["Benar", "Palsu"],
                correct: 0,
                type: "truefalse"
            },
            {
                question: "Warna biru pada bendera melambangkan perpaduan rakyat.",
                answers: ["Benar", "Palsu"],
                correct: 0,
                type: "truefalse"
            },
            {
                question: "Tunku Abdul Rahman melaungkan 'Merdeka!' sebanyak 5 kali.",
                answers: ["Benar", "Palsu"],
                correct: 1,
                type: "truefalse"
            },
            {
                question: "Suruhanjaya Cobbold ditubuhkan untuk menilai kesediaan Sabah dan Sarawak menyertai Malaysia.",
                answers: ["Benar", "Palsu"],
                correct: 0,
                type: "truefalse"
            },
            // BAHAGIAN B: ISU SEMASA MALAYSIA (10 SOALAN)
            {
                question: "Apakah inisiatif kerajaan Malaysia untuk ekonomi digital dan AI?",
                answers: ["MyDigital & Malaysia Madani", "Rangka Tindakan Ekonomi Madani", "Malaysia Digital Economy Blueprint (MyDIGITAL)", "Dasar Automasi Kebangsaan"],
                correct: 2
            },
            {
                question: "Siapakah Perdana Menteri Malaysia pada tahun 2025?",
                answers: ["Ismail Sabri", "Anwar Ibrahim", "Muhyiddin Yassin", "Mahathir Mohamad"],
                correct: 1
            },
            {
                question: "Apakah isu utama kenaikan kos sara hidup tahun 2024?",
                answers: ["Kadar jenayah", "Inflasi & harga barang", "Kurang buruh asing", "Krisis kesihatan"],
                correct: 1
            },
            {
                question: "Negara perdagangan terbesar Malaysia tahun 2024?",
                answers: ["Singapura", "China", "Indonesia", "Amerika"],
                correct: 1
            },
            {
                question: "Nama program subsidi petrol bersasar?",
                answers: ["Subsidi Prihatin", "MyPetrol", "Budi Madani", "MyBantuan"],
                correct: 2
            },
            {
                question: "Inisiatif bantu belia dalam latihan dan pekerjaan?",
                answers: ["MyBelia", "TVET Madani", "Skim Latihan Nasional", "Prihatin Belia"],
                correct: 1
            },
            {
                question: "Langkah kerajaan tangani scam online?",
                answers: ["Hapus eWallet", "NSRC", "Suruhanjaya Anti Scam", "Blok transaksi luar"],
                correct: 1
            },
            {
                question: "Apakah objektif utama Ekonomi Madani?",
                answers: ["Tambah hutang negara", "Pelaburan asing sahaja", "Masyarakat saksama & pendapatan rakyat", "Kurang eksport"],
                correct: 2
            },
            // Final 2 Benar/Palsu questions
            {
                question: "Malaysia isytihar darurat kesihatan kerana jerebu 2024.",
                answers: ["Benar", "Palsu"],
                correct: 1,
                type: "truefalse"
            },
            {
                question: "Kerajaan galak guna tenaga boleh diperbaharui seperti solar.",
                answers: ["Benar", "Palsu"],
                correct: 0,
                type: "truefalse"
            }
        ];

        // Game state
        let currentQuestionIndex = 0;
        let score = 0;
        let timeLeft = 30;
        let totalTimeSpent = 0;
        let questionStartTime = 0;
        let timer;
        let playerFullName = '';
        let playerPhone = '';
        let leaderboard = JSON.parse(localStorage.getItem('merdeka-leaderboard')) || [];
        let allParticipants = JSON.parse(localStorage.getItem('merdeka-participants')) || [];

        // Start quiz
        function startQuiz() {
            playerFullName = document.getElementById('playerFullName').value.trim().toUpperCase();
            playerPhone = document.getElementById('playerPhone').value.trim();
            
            if (!playerFullName) {
                alert('Sila masukkan nama penuh anda!');
                return;
            }
            
            if (!playerPhone || playerPhone.length < 10) {
                alert('Sila masukkan nombor telefon yang sah!');
                return;
            }
            
            // Validate phone number format
            const phoneRegex = /^[0-9+\-\s()]+$/;
            if (!phoneRegex.test(playerPhone)) {
                alert('Format nombor telefon tidak sah!');
                return;
            }
            
            document.getElementById('startScreen').classList.add('hidden');
            document.getElementById('quizScreen').classList.remove('hidden');
            
            currentQuestionIndex = 0;
            score = 0;
            totalTimeSpent = 0;
            
            showQuestion();
        }

        // Show current question
        function showQuestion() {
            const question = quizData[currentQuestionIndex];
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            document.getElementById('totalQuestions').textContent = 40;
            document.getElementById('questionText').textContent = question.question;
            
            const answersContainer = document.getElementById('answersContainer');
            answersContainer.innerHTML = '';
            
            question.answers.forEach((answer, index) => {
                const button = document.createElement('button');
                button.className = 'w-full p-4 text-left bg-gray-50 hover:bg-blue-50 border-2 border-gray-200 hover:border-blue-300 rounded-lg transition-all text-lg';
                button.textContent = answer;
                button.onclick = () => selectAnswer(index);
                answersContainer.appendChild(button);
            });
            
            // Update progress bar
            const progress = ((currentQuestionIndex + 1) / quizData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            
            // Start timer
            timeLeft = 30;
            questionStartTime = Date.now();
            updateTimer();
            timer = setInterval(updateTimer, 1000);
        }

        // Update timer
        function updateTimer() {
            document.getElementById('timer').textContent = timeLeft;
            timeLeft--;
            
            if (timeLeft < 0) {
                clearInterval(timer);
                selectAnswer(-1); // Time's up, wrong answer
            }
        }

        // Select answer
        function selectAnswer(selectedIndex) {
            clearInterval(timer);
            
            const questionTime = (Date.now() - questionStartTime) / 1000;
            totalTimeSpent += questionTime;
            
            const question = quizData[currentQuestionIndex];
            const buttons = document.querySelectorAll('#answersContainer button');
            
            // Show correct/incorrect
            buttons.forEach((button, index) => {
                if (index === question.correct) {
                    button.classList.add('bg-green-500', 'text-white', 'border-green-500');
                } else if (index === selectedIndex && selectedIndex !== question.correct) {
                    button.classList.add('bg-red-500', 'text-white', 'border-red-500');
                }
                button.disabled = true;
            });
            
            if (selectedIndex === question.correct) {
                score++;
            }
            
            // Move to next question after delay
            setTimeout(() => {
                currentQuestionIndex++;
                if (currentQuestionIndex < quizData.length) {
                    showQuestion();
                } else {
                    showResults();
                }
            }, 2000);
        }

        // Show results
        function showResults() {
            document.getElementById('quizScreen').classList.add('hidden');
            document.getElementById('resultsScreen').classList.remove('hidden');
            
            document.getElementById('finalScore').textContent = score;
            document.getElementById('totalTime').textContent = Math.round(totalTimeSpent);
            document.getElementById('displayName').textContent = playerFullName;
            document.getElementById('displayPhone').textContent = playerPhone;
            
            // Add to participants list (for admin)
            const participantData = {
                fullName: playerFullName,
                phone: playerPhone,
                score: score,
                time: Math.round(totalTimeSpent),
                date: new Date().toLocaleDateString('ms-MY'),
                timestamp: new Date().toISOString()
            };
            
            allParticipants.push(participantData);
            localStorage.setItem('merdeka-participants', JSON.stringify(allParticipants));
            
            // Add to leaderboard (display only)
            const playerResult = {
                name: playerFullName,
                score: score,
                time: Math.round(totalTimeSpent),
                date: new Date().toLocaleDateString('ms-MY')
            };
            
            leaderboard.push(playerResult);
            
            // Sort leaderboard: first by score (desc), then by time (asc)
            leaderboard.sort((a, b) => {
                if (b.score !== a.score) {
                    return b.score - a.score;
                }
                return a.time - b.time;
            });
            
            // Keep only top 10 for display
            leaderboard = leaderboard.slice(0, 10);
            
            localStorage.setItem('merdeka-leaderboard', JSON.stringify(leaderboard));
        }

        // Show leaderboard
        function showLeaderboard() {
            document.getElementById('resultsScreen').classList.add('hidden');
            document.getElementById('leaderboardScreen').classList.remove('hidden');
            
            const leaderboardList = document.getElementById('leaderboardList');
            leaderboardList.innerHTML = '';
            
            if (leaderboard.length === 0) {
                leaderboardList.innerHTML = '<p class="text-center text-gray-500">Tiada rekod lagi</p>';
                return;
            }
            
            leaderboard.forEach((player, index) => {
                const entry = document.createElement('div');
                entry.className = 'flex items-center justify-between p-4 bg-gray-50 rounded-lg border-2';
                
                if (index === 0) {
                    entry.classList.add('bg-yellow-50', 'border-yellow-300');
                } else if (index === 1) {
                    entry.classList.add('bg-gray-100', 'border-gray-300');
                } else if (index === 2) {
                    entry.classList.add('bg-orange-50', 'border-orange-300');
                }
                
                const medal = index === 0 ? 'ü•á' : index === 1 ? 'ü•à' : index === 2 ? 'ü•â' : `${index + 1}.`;
                
                entry.innerHTML = `
                    <div class="flex items-center space-x-4">
                        <span class="text-2xl font-bold">${medal}</span>
                        <div>
                            <div class="font-semibold text-lg">${player.name}</div>
                            <div class="text-sm text-gray-600">${player.date}</div>
                        </div>
                    </div>
                    <div class="text-right">
                        <div class="font-bold text-lg text-blue-600">${player.score}/40</div>
                        <div class="text-sm text-gray-600">${player.time}s</div>
                    </div>
                `;
                
                leaderboardList.appendChild(entry);
            });
        }

        // Restart quiz
        function restartQuiz() {
            document.getElementById('resultsScreen').classList.add('hidden');
            document.getElementById('leaderboardScreen').classList.add('hidden');
            document.getElementById('startScreen').classList.remove('hidden');
            document.getElementById('playerFullName').value = '';
            document.getElementById('playerPhone').value = '';
        }

        // Admin functions
        function showAdminLogin() {
            document.getElementById('startScreen').classList.add('hidden');
            document.getElementById('adminLoginScreen').classList.remove('hidden');
        }

        function backToStart() {
            document.getElementById('adminLoginScreen').classList.add('hidden');
            document.getElementById('startScreen').classList.remove('hidden');
            
            // Reset login form
            document.getElementById('adminId').value = '';
            document.getElementById('adminPassword').value = '';
            document.getElementById('loginError').classList.add('hidden');
            
            // Reset field borders
            document.getElementById('adminId').classList.remove('border-red-500');
            document.getElementById('adminId').classList.add('border-gray-300');
            document.getElementById('adminPassword').classList.remove('border-red-500');
            document.getElementById('adminPassword').classList.add('border-gray-300');
        }

        function adminLogin() {
            const adminId = document.getElementById('adminId').value.trim();
            const adminPassword = document.getElementById('adminPassword').value.trim();
            const errorDiv = document.getElementById('loginError');
            const errorMessage = document.getElementById('errorMessage');
            
            // Hide previous error
            errorDiv.classList.add('hidden');
            
            // Check if fields are empty
            if (!adminId || !adminPassword) {
                errorMessage.textContent = '‚ö†Ô∏è Sila isi kedua-dua medan ID dan password!';
                errorDiv.classList.remove('hidden');
                return;
            }
            
            // Check credentials
            if (adminId === 'MKP_2025' && adminPassword === 'MKPMultimedia2025') {
                // Success - hide error and proceed
                errorDiv.classList.add('hidden');
                document.getElementById('adminLoginScreen').classList.add('hidden');
                document.getElementById('adminPanel').classList.remove('hidden');
                loadAdminData();
            } else {
                // Show specific error messages
                if (adminId !== 'MKP_2025') {
                    errorMessage.textContent = '‚ùå ID admin tidak dijumpai! ID yang betul: MKP_2025';
                } else if (adminPassword !== 'MKPMultimedia2025') {
                    errorMessage.textContent = '‚ùå Password salah! Sila semak semula password anda.';
                }
                
                errorDiv.classList.remove('hidden');
                
                // Add red border to incorrect fields
                const idField = document.getElementById('adminId');
                const passwordField = document.getElementById('adminPassword');
                
                if (adminId !== 'MKP_2025') {
                    idField.classList.add('border-red-500');
                    idField.classList.remove('border-gray-300');
                } else {
                    idField.classList.remove('border-red-500');
                    idField.classList.add('border-gray-300');
                }
                
                if (adminPassword !== 'MKPMultimedia2025') {
                    passwordField.classList.add('border-red-500');
                    passwordField.classList.remove('border-gray-300');
                } else {
                    passwordField.classList.remove('border-red-500');
                    passwordField.classList.add('border-gray-300');
                }
            }
        }

        function logoutAdmin() {
            document.getElementById('adminPanel').classList.add('hidden');
            document.getElementById('startScreen').classList.remove('hidden');
            document.getElementById('adminId').value = '';
            document.getElementById('adminPassword').value = '';
        }

        function loadAdminData() {
            const participants = JSON.parse(localStorage.getItem('merdeka-participants')) || [];
            
            // Update statistics
            document.getElementById('totalParticipants').textContent = participants.length;
            
            if (participants.length > 0) {
                const avgScore = (participants.reduce((sum, p) => sum + p.score, 0) / participants.length).toFixed(1);
                const avgTime = Math.round(participants.reduce((sum, p) => sum + p.time, 0) / participants.length);
                
                document.getElementById('averageScore').textContent = avgScore;
                document.getElementById('averageTime').textContent = avgTime + 's';
            }
            
            // Populate table
            const tableBody = document.getElementById('adminDataTable');
            tableBody.innerHTML = '';
            
            participants.forEach((participant, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="border border-gray-300 px-4 py-2">${index + 1}</td>
                    <td class="border border-gray-300 px-4 py-2">${participant.fullName}</td>
                    <td class="border border-gray-300 px-4 py-2">${participant.phone}</td>
                    <td class="border border-gray-300 px-4 py-2">${participant.score}/40</td>
                    <td class="border border-gray-300 px-4 py-2">${participant.time}</td>
                    <td class="border border-gray-300 px-4 py-2">${participant.date}</td>
                `;
                tableBody.appendChild(row);
            });
        }

        function exportData() {
            const participants = JSON.parse(localStorage.getItem('merdeka-participants')) || [];
            
            if (participants.length === 0) {
                alert('Tiada data untuk diexport!');
                return;
            }
            
            // Create CSV content
            let csvContent = 'No,Nama Penuh,No Telefon,Skor,Masa (saat),Tarikh\n';
            
            participants.forEach((participant, index) => {
                csvContent += `${index + 1},"${participant.fullName}","${participant.phone}",${participant.score},${participant.time},"${participant.date}"\n`;
            });
            
            // Download CSV
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `kuiz-merdeka-data-${new Date().toISOString().split('T')[0]}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function clearAllData() {
            if (confirm('Adakah anda pasti mahu memadam SEMUA data? Tindakan ini tidak boleh dibatalkan!')) {
                if (confirm('Pengesahan terakhir: Semua data peserta akan dipadam secara kekal!')) {
                    localStorage.removeItem('merdeka-participants');
                    localStorage.removeItem('merdeka-leaderboard');
                    allParticipants = [];
                    leaderboard = [];
                    loadAdminData();
                    alert('Semua data telah dipadam!');
                }
            }
        }

        // Dark Mode Functions
        function toggleDarkMode() {
            const body = document.getElementById('body');
            const darkModeIcon = document.getElementById('darkModeIcon');
            const isDark = localStorage.getItem('darkMode') === 'true';
            
            if (isDark) {
                // Switch to light mode
                body.className = 'bg-gradient-to-br from-red-50 to-blue-50 min-h-screen transition-all duration-300';
                darkModeIcon.textContent = 'üåô';
                localStorage.setItem('darkMode', 'false');
                applyLightMode();
            } else {
                // Switch to dark mode
                body.className = 'bg-gradient-to-br from-gray-900 to-gray-800 min-h-screen transition-all duration-300';
                darkModeIcon.textContent = '‚òÄÔ∏è';
                localStorage.setItem('darkMode', 'true');
                applyDarkMode();
            }
        }

        function applyDarkMode() {
            // Update all containers and cards
            document.querySelectorAll('.bg-white').forEach(element => {
                element.classList.remove('bg-white');
                element.classList.add('bg-gray-800', 'text-white');
            });
            
            // Update text colors
            document.querySelectorAll('.text-gray-800, .text-gray-700, .text-gray-600, .text-gray-500').forEach(element => {
                element.classList.add('text-gray-200');
            });
            
            // Update input fields
            document.querySelectorAll('input').forEach(input => {
                input.classList.add('bg-gray-700', 'text-white', 'border-gray-600', 'placeholder-gray-400');
                input.classList.remove('border-gray-300');
            });
            
            // Update answer buttons
            document.querySelectorAll('.bg-gray-50').forEach(button => {
                button.classList.remove('bg-gray-50', 'hover:bg-blue-50', 'border-gray-200', 'hover:border-blue-300');
                button.classList.add('bg-gray-700', 'text-white', 'hover:bg-gray-600', 'border-gray-600', 'hover:border-gray-500');
            });
            
            // Update table headers
            document.querySelectorAll('.bg-gray-100').forEach(header => {
                header.classList.remove('bg-gray-100');
                header.classList.add('bg-gray-700', 'text-white');
            });
            
            // Update table borders
            document.querySelectorAll('.border-gray-300').forEach(element => {
                element.classList.remove('border-gray-300');
                element.classList.add('border-gray-600');
            });
            
            // Update leaderboard entries
            document.querySelectorAll('#leaderboardList .bg-gray-50').forEach(entry => {
                entry.classList.remove('bg-gray-50');
                entry.classList.add('bg-gray-700', 'text-white');
            });
        }

        function applyLightMode() {
            // Restore white backgrounds
            document.querySelectorAll('.bg-gray-800').forEach(element => {
                element.classList.remove('bg-gray-800', 'text-white');
                element.classList.add('bg-white');
            });
            
            // Restore text colors
            document.querySelectorAll('.text-gray-200').forEach(element => {
                element.classList.remove('text-gray-200');
            });
            
            // Restore input fields
            document.querySelectorAll('input').forEach(input => {
                input.classList.remove('bg-gray-700', 'text-white', 'border-gray-600', 'placeholder-gray-400');
                input.classList.add('border-gray-300');
            });
            
            // Restore answer buttons
            document.querySelectorAll('.bg-gray-700').forEach(button => {
                if (button.classList.contains('hover:bg-gray-600')) {
                    button.classList.remove('bg-gray-700', 'text-white', 'hover:bg-gray-600', 'border-gray-600', 'hover:border-gray-500');
                    button.classList.add('bg-gray-50', 'hover:bg-blue-50', 'border-gray-200', 'hover:border-blue-300');
                }
            });
            
            // Restore table headers
            document.querySelectorAll('thead .bg-gray-700').forEach(header => {
                header.classList.remove('bg-gray-700', 'text-white');
                header.classList.add('bg-gray-100');
            });
            
            // Restore table borders
            document.querySelectorAll('.border-gray-600').forEach(element => {
                element.classList.remove('border-gray-600');
                element.classList.add('border-gray-300');
            });
        }

        // Initialize dark mode on page load
        function initializeDarkMode() {
            const savedDarkMode = localStorage.getItem('darkMode');
            if (savedDarkMode === 'true') {
                const body = document.getElementById('body');
                const darkModeIcon = document.getElementById('darkModeIcon');
                body.className = 'bg-gradient-to-br from-gray-900 to-gray-800 min-h-screen transition-all duration-300';
                darkModeIcon.textContent = '‚òÄÔ∏è';
                
                // Apply dark mode styles
                setTimeout(applyDarkMode, 100);
            }
        }

        // Initialize dark mode when page loads
        document.addEventListener('DOMContentLoaded', initializeDarkMode);
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96757fc1171e3c5c',t:'MTc1Mzg4NTI1MS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
